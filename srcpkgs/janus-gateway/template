# Template file for 'janus-gateway'
pkgname=janus-gateway
version=1.1.3
revision=1
build_style=gnu-configure
configure_args="--enable-docs"
hostmakedepends="autogen automake doxygen graphviz libtool pkg-config"
# TODO missing (optional) dependencies:
# - usrsctp https://github.com/sctplab/usrsctp
# - paho.mqtt.c https://www.eclipse.org/paho/index.php?page=clients/c/index.php
# - Sofia-SIP https://github.com/freeswitch/sofia-sip
makedepends="duktape-devel jansson-devel libconfig-devel libmicrohttpd-devel
 libnice-devel libogg-devel libopusenc-devel libsrtp-devel libwebsockets-devel
 lua-devel nanomsg-devel openssl-devel rabbitmq-c-devel"
short_desc="A general purpose WebRTC server"
maintainer="Adam Gausmann <adam@gaussian.dev>"
license="GPL-3.0-or-later"
homepage="https://janus.conf.meetecho.com"
changelog="https://raw.githubusercontent.com/meetecho/janus-gateway/master/CHANGELOG.md"
distfiles="https://github.com/meetecho/janus-gateway/archive/refs/tags/v${version}.tar.gz"
checksum=f87d322cbe0cd8a7f1e83082445e4d62106a42ca5cfa8b636df1eb5ab8b1ce7b

pre_configure() {
	./autogen.sh
}

post_install() {
	vsv janus
}

janus-gateway-doc_package() {
	short_desc+=" - documentation"
	pkg_install() {
		vmove usr/share/doc
	}
}
